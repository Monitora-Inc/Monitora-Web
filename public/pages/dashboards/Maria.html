<!DOCTYPE html>
<html lang="pt">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Monitoramento de Tráfego de Rede</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="icon" href="../../assets/logos/logo_vetorizada.svg" type="image/x-icon">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../../style/sidebar.css">
  <link rel="stylesheet" href="../../style/essencial.css">
  <link rel="stylesheet" href="../../style/tela_home.css">
  <link rel="stylesheet" href="../../style/filtros.css">
  <link rel="stylesheet" href="../../style/popup.css">
  <link rel="stylesheet" href="../../style/Maria.css">
  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>

</head>

<body onload="listarPermissoesReload()">
  <nav id="id_sidebar"></nav>

  <div class="sombra_modal" id="sombra_modal">
    <div class="modal">
      <h2>Interpretação do Gráfico <i class="fa-regular fa-circle-xmark" onclick="fecharModal()"></i> </h2>
      <p>
        <li>Cada célula mostra o quanto duas variáveis estão relacionadas, de -1 a 1.</li>

          <li>Cor mais escura = relação mais forte.</li>

         <li> Valor positivo: quando uma sobe, a outra tende a subir.</li>

          <li>Valor negativo: quando uma sobe, a outra tende a cair.</li>

          <li>Valor próximo ou igual à zero: pouca ou nenhuma relação.</li>

         <li> Linhas e colunas representam os eventos; a célula mostra a força da relação entre eles.</li>
      </p>
    </div>
  </div>
  <header>
    <div class="titulo-dash">
      <i class="fa-solid fa-chart-simple"></i>
      <h1> Monitoramento de Tráfego de Rede</h1>
    </div>

  </header>

  <div class="row">
    <button class="btn-primary">Últimas 24h</button>
    <button>7 dias</button>
    <button>30 dias</button>
    <button>Período Customizado <i class="fa-regular fa-calendar"></i></button>



  </div>

  <div class="page_content main">

    <div class="grid grid-6">
      <div class="card">
        <p class="text-kpi">Tráfego Médio na <br> Última Hora
          <i class="fa-solid fa-arrow-right-arrow-left"></i>
        </p>
        <p class="value">1.2 Tbit/s</p>
      </div>
      <div class="card">
        <p class="text-kpi">Perda de Pacotes
          <i class="fa-solid fa-box-archive"></i>
        </p>
        <p class="value">0.05%</p>
      </div>
      <div class="card">
        <p class="text-kpi">Dados Totais
          <i class="fa-solid fa-database"></i>
        </p>
        <p class="value">850 TB</p>
      </div>
      <div class="card">
        <p class="text-kpi">Capacidade Utilizada
          <i class="fa-solid fa-bars-progress"></i>
        </p>

        <div class="progress-bar">
          <div class="progress-fill" style="width: 70%;"></div>
        </div>
        <p class="value">70%</p>
      </div>

    </div>

    <div class="container-graficos first">
      <div class="grafico-card">
        <div class="grafico-header">
          <h3>Correlação: Eventos de Rede x Tráfego</h3>
          <i class="fa-regular fa-circle-question" onclick="abrirModal()"></i>
        </div>
        <div id="correlationHeatmap"></div>
      </div>
      <div id="chart"></div>
    </div>
    <div class="container-graficos second">
      <div id="previsao"></div>
    </div>

  </div>


</body>
<script src="../../js/sidebar.js"></script>
<script src="../../js/popups.js"></script>
<script src="../../js/verificacaoPermissoes.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
  integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js"
  integrity="sha384-G/EV+4j2dNv+tEPo3++6LCgdCROaejBqfUeNjuKAiuXbjrxilcCdDz6ZAVfHWe1Y" crossorigin="anonymous"></script>

</html>

<script>



  if (sessionStorage.empresaCnpj == undefined) {
    listarPermissoesReload();
    verificarPermissoesSideBar();
    setInterval(executarVerificacaoPermissoes, 30000);
  }

  function executarVerificacaoPermissoes() {
    if (sessionStorage.empresaCnpj == undefined) {
      listarPermissoesReload();
      verificarPermissoesSideBar();
    }
  }

  if (sessionStorage.empresaCnpj == undefined) {
    verificarPermissoesSideBar();
  }


</script>

<Script>
  function abrirModal() {
    document.getElementById("sombra_modal").style.display = "flex";
  }

  function fecharModal() {
    document.getElementById("sombra_modal").style.display = "none";
  }
</Script>

<script>
  let data = [];

  const correlacao = [
    [1, 0.06, -0.10, 0.05],   // trafego
    [0.06, 1, 0.17, -0.18],   // incidentes
    [-0.10, 0.17, 1, -0.09],   // final_semana
    [0.05, -0.18, -0.09, 1]       // feriado
  ];

  const labels = ["tráfego", "perda_pacotes", "final_semana", "feriado"];

  for (let i = 0; i < correlacao.length; ++i) {
    for (let j = 0; j < correlacao.length; ++j) {
      data.push({
        name: `${labels[i]}-${labels[j]}`,
        value: [j, i, correlacao[i][j]]
      });
    }
  }


  const xData = ["trafego", "perda_pacotes", "final_semana", "feriado"];
  const yData = ["trafego", "perda_pacotes", "final_semana", "feriado"];

  for (let i = 0; i < correlacao.length; ++i) {
    for (let j = 0; j < correlacao.length; ++j) {
      data.push([labels[j], labels[i], correlacao[i][j]]);
    }
  }
  option = {
    tooltip: {
      position: 'top',
      formatter: (params) => {
        return `
        <b>${labels[params.value[1]]}</b> x 
        <b>${labels[params.value[0]]}</b> <br>
        Correlação: <b>${params.value[2].toFixed(2)}</b>
      `;
      },
      backgroundColor: 'rgba(50, 50, 50, 0.85)',
      borderRadius: 8,
      padding: 10,
      textStyle: {
        color: '#fff'
      }
    },
    matrix: {
      x: {
        data: xData
      },
      y: {
        data: yData
      },

    },
    visualMap: {
      type: 'continuous',
      min: -1,
      max: 1,
      calculable: true,
      left: -10,
      top: 'middle',
      itemHeight: 120,
      itemWidth: 10,
      text: ['Alto', 'Baixo'],
      textStyle: { color: '#475569', fontWeight: 600 },


    },
    series: {
      type: 'heatmap',
      coordinateSystem: 'matrix',
      data: data,
      label: {
        show: true,
        formatter: (params) => params.value[2].toFixed(2)
      },


    },


  };
  var chartDom = document.getElementById('correlationHeatmap');
  var myChart = echarts.init(chartDom);
  myChart.setOption(option);


  //-------------------------------------------------------------------

  const df = [
    { data: "2025-11-20", prob: 0.12 },
    { data: "2025-11-22", prob: 0.58 },
    { data: "2025-12-25", prob: 0.92 }
  ];

  const serieApex = df.map(item => ({
    x: item.data,
    y: item.prob
  }));



  var options = {
    chart: {
      type: 'line',
      height: 350,
      width: '100%',
      toolbar: {
        show: false
      },
      foreColor: '#555'
    },
    markers: {
      size: 6,
      colors: ['#c1121f'],
      strokeColors: '#fff',
      strokeWidth: 2,
      hover: {
        size: 8,
      }
    },

    series: [{
      name: "Probabilidade de Pico",
      data: serieApex

    }],

    stroke: {
      width: 4,
      curve: "smooth",

      colors: ['#003566']
    },

    xaxis: {
      type: "datetime",
      labels: {
        style: {
          fontSize: '12px',
          colors: '#6b7280'
        }

      },
      datetimeFormatter: {
        year: 'yyyy',
        month: 'MMM \'yy',
        day: 'dd/MM'
      },
      title: {
        text: 'Data',
        style: {
          fontWeight: 'bold',
          color: '#475569',

        }
      }
    },

    yaxis: {
      min: 0,
      max: 1,
      labels: {
        formatter: val => (val * 100).toFixed(0) + '%'
      },
      title: {
        text: 'Probabilidade de Pico (%)',
        style: {
          fontWeight: 'bold',


        }
      }
    },

    title: {
      text: "Previsão de Picos de Tráfego (Regressão Logística)",
      align: "left",
      style: {
        fontSize: 16,
        fontWeight: 'bold',
        fontFamily: "'Inter', sans-serif"


      }
    },


  };

  var chart = new ApexCharts(document.querySelector("#previsao"), options);
  chart.render();

  //----------------------------------------------------------------------------
  var options = {
    series: [{
      name: "Desktops",
      data: [10, 41, 35, 51, 49, 62, 69, 91, 148]
    }],
    chart: {
      height: 350,
      type: 'line',
      zoom: {
        enabled: false
      },
      toolbar: {
        show: false
      }
    },

    dataLabels: {
      enabled: false
    },
    stroke: {
      curve: 'straight'
    },
    title: {
      text: 'Tráfego nas Últimas Horas',
      align: 'left',
      style: {
        fontFamily: "'Inter', sans-serif",
        fontWeight: 'bold',
        fontSize: 14,
        color: '#1f2937'

      }
    },
    grid: {
      row: {
        colors: ['#f3f3f3', 'transparent'],
        opacity: 0.5
      },
    },
    xaxis: {
      categories: ['1h', '2h', '3h', '4h', '5h', '6h', '7h', '8h', '9h'],
      title: {
        text: 'Horário',
        style: {
          fontWeight: 'bold',
          color: '#475569',

        }
      }
    },
    yaxis: {
      title: {
        text: 'Velocidade do Tráfego (Taxa de Transferência)',
        style: {
          fontWeight: 'bold',
          color: '#475569',

        }
      }
    }
  };

  var chart = new ApexCharts(document.querySelector("#chart"), options);
  chart.render();



</script>