<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Incidentes</title>
  <link rel="icon" href="../../assets/logos/logo_vetorizada.svg" type="image/x-icon">
  <link rel="stylesheet" href="../../style/sidebar.css">
  <link rel="stylesheet" href="../../style/filtros.css">
  <link rel="stylesheet" href="../../style/essencial.css">
  <link rel="stylesheet" href="../../style/dashLeo.css">
  <link rel="stylesheet" href="../../style/popup.css">
</head>

<body>

  <body onload="listarPermissoesReload(), pegarDataUltimaAtualizacao(), preencherKpisServidoresAlertas()">
    <nav id="id_sidebar"></nav>
    <div id="id_info_kpis"></div>
    <div id="popup_screen"></div>

    <div class="page_content">
      <div class="dashButtons" style="margin-top: -2vh; margin-bottom: 2vh;">
        <a href="./home.html"><img style="border-radius: 0 !important" src="../../Images/home.svg" alt=""></a>
        <a href="./Ally.html"><img src="../../Images/Colaboradores/Colaborador1.svg" alt=""></a>
        <a href="./Gustavo.html "><img src="../../Images/Colaboradores/Colaborador2.svg" alt=""></a>
        <a href="./Leonardo.html"><img src="../../Images/Colaboradores/Colaborador3.svg" alt=""></a>
        <a href="./Maria.html"><img src="../../Images/Colaboradores/Colaborador4.svg" alt=""></a>
        <a href="./Pedro.html"><img src="../../Images/Colaboradores/Colaborador5.svg" alt=""></a>
      </div>
      <div class="cards">
        <section class="cards_kpi1">
          <div class="kpisIncidentes">
            <div class="tituloDiv">
              <h3>Dashboard de Gest√£o de Incidentes</h3>
              <p id="dataUltimaAtualizacao">√öltima atualiza√ß√£o:</p>
              <p>Dados referentes aos √∫ltimos 30 dias</p>
            </div>
            <div class="card" style="width: 30%;">
              <p class="titulo">Registrados</p>
              <div style="display: flex; align-items: center; justify-content: space-around; width: 100%; padding-top: 3.5vh;">
                <div style="width: 50%; text-align: center; border-right: solid 0.3px #072F4E;">
                  <h2 id="incidentesRegistrados" style="padding-top: 0;"></h2>
                  <p>Totais</p>
                </div>
                <div style="border-left: solid 0.3px #072F4E; border-right: solid 0.3px #072F4E; width: 50%; text-align: center;">
                  <h2 id="incidentesCriticosTotais" style="padding-top: 0;"></h2>
                  <p>Cr√≠ticos</p>
                </div>
                <div style="border-left: solid 0.3px #072F4E; width: 50%; text-align: center;">
                  <h2 id="incidentesAtencaoTotais" style="padding-top: 0;"></h2>
                  <p>Aten√ß√£o</p>
                </div>
              </div>
            </div>
            <div class="card" style="width: 30%;">
              <p class="titulo">Em aberto</p>
              <div style="display: flex; align-items: center; justify-content: space-around; width: 100%; padding-top: 3.5vh;">
                <div style="width: 50%; text-align: center; border-right: solid 0.3px #072F4E;">
                  <h2 id="incidentesAbertos" style="padding-top: 0;"></h2>
                  <p>Totais</p>
                </div>
                <div
                  style="border-right: solid 0.3px #072F4E; border-left: solid 0.3px #072F4E; width: 50%; text-align: center;">
                  <h2 id="incidentesCriticosAbertos" style="padding-top: 0;"></h2>
                  <p>Cr√≠ticos</p>
                </div>
                <div style="border-left: solid 0.3px #072F4E; width: 50%; text-align: center;">
                  <h2 id="incidentesAtencaoAbertos" style="padding-top: 0;"></h2>
                  <p>Aten√ß√£o</p>
                </div>
              </div>
            </div>
            <div class="card" style="border-top-right-radius: 7px; border-bottom-right-radius: 7px; width: 10%;">
              <p class="titulo">Fechados</p>
              <h2 id="incidentesFechados"></h2>
            </div>
          </div>
        </section>
        <section class="cards_kpi2">
          <div class="card">
            <div id="divIconeMTBF" class="divIcone" style="background-color: #FFCA67;">
              <img src="../../Images/PopUpsDash/alerta.svg">
              <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMTBF()">
            </div>
            <div id="conteudoMTBF" class="conteudoCardPerformance">
              <p class="titulo">Tempo M√©dio Entre Falhas (MTBF)</p>
              <h2 id="mtbf" style="color: #D2A043;"></h2>
              <p class="descricao"><i>Tempo m√©dio que o sistema opera antes de falhas.</i></p>
            </div>
          </div>
          <div class="card">
            <div id="divIconeMTTRCritico" class="divIcone" style="background-color: #FF0267;">
              <img src="../../Images/PopUpsDash/critico.svg">
              <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMttrCritico()">
            </div>
            <div id="conteudoMTTRCritico" class="conteudoCardPerformance">
              <p class="titulo">Tempo M√©dio de Resolu√ß√£o (MTTR) - Cr√≠ticos</p>
              <h2 id="mttrCritico" style="color: #B4044B;"></h2>
              <p class="descricao"><i>Tempo m√©dio gasto para resolu√ß√£o de um incidente cr√≠tico.</i></p>
            </div>
          </div>
          <div class="card">
            <div id="divIconeMTTRAtencao" class="divIcone" style="background-color: #FF0267;">
              <img src="../../Images/PopUpsDash/critico.svg">
              <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMttrAtencao()">
            </div>
            <div id="conteudoMTTRAtencao" class="conteudoCardPerformance">
              <p class="titulo">Tempo M√©dio de Resolu√ß√£o (MTTR) - Aten√ß√£o</p>
              <h2 id="mttrAtencao" style="color: #B4044B;"></h2>
              <p class="descricao"><i>Tempo m√©dio gasto para resolu√ß√£o de um incidente de aten√ß√£o.</i></p>
            </div>
          </div>
          <div class="card">
            <div id="divIconeSLA" class="divIcone" style="background-color: #00F2B9;">
              <img src="../../Images/PopUpsDash/ok.svg">
              <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoSLA()">
            </div>
            <div id="conteudoSLA" class="conteudoCardPerformance">
              <p class="titulo">SLA Compliance - Incidentes Resolvidos</p>
              <h2 id="slaCompliance" style="color: #219A7E;"></h2>
              <p class="descricao"><i>Taxa de incidentes resolvidos no prazo definido em SLA.</i></p>
            </div>
          </div>
        </section>
      </div>
      <div class="cards_grandes">
        <div class="cards_componentes">
          <div class="card">
            <h3>Componente(s) com mais incidentes:</h3>
            <p id="componentesComMaisIncidentes"></p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Componente</th>
                <th>Incidentes totais</th>
                <th>Incidentes cr√≠ticos</th>
                <th>Incidentes de aten√ß√£o</th>
              </tr>
            </thead>
            <tbody id="dataTable"></tbody>
          </table>
        </div>
        <div class="card_grafico">
          <div class="card">
            <h3 style="font-size: 7vh;">Gr√°fico:</h3>
            <select style="width: 25vw; height: 8vh; font-size: 2.4vh;" id="selecionarGrafico"
              onchange="alterarGrafico(this.value)">
              <option value="1" selected>Incidentes: Abertos VS Fechados</option>
              <option value="2">Incidentes Abertos por Componente</option>
            </select>
          </div>
          <div id="grafico"></div>
        </div>
      </div>
    </div>
  </body>

</html>
<script src="../../js/sidebar.js"></script>
<script src="../../js/popups.js"></script>
<script src="../../js/verificacaoPermissoes.js"></script>

<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script>
  iniciarDashboard();

  async function iniciarDashboard() {
  try {
    const incidentesPromise = buscarKpisIncidentes();
    const componentesPromise = buscarDadosComponentes();
    const performancePromise = buscarKpisPerformance();
    const graficoPromise = carregarGrafico();

    await Promise.all([
      incidentesPromise,
      componentesPromise,
      performancePromise,
      graficoPromise
    ]);

  } catch (erro) {
    console.error("Erro ao carregar dados da dashboard:", erro);
  }
}

  let jsonKpisIncidentes;

  function buscarKpisIncidentes() {
    const fetchPromise = fetch("https://baiqze345xsjipst2bsfdm7wx40tsnni.lambda-url.us-east-1.on.aws/");

    fetchPromise
      .then((response) => response.json())
      .then((data) => {
        jsonKpisIncidentes = data;
        console.log(data);
        incidentesAbertos.innerHTML = `${data.abertos}`;
        incidentesCriticosAbertos.innerHTML = `${data.criticosAbertos}`;
        if (data.criticosAbertos > 0) {
          incidentesCriticosAbertos.style.color = '#FF0267';
        } 
        incidentesCriticosTotais.innerHTML = `${data.criticosTotais}`;
        incidentesAtencaoAbertos.innerHTML = `${data.atencaoAbertos}`;
        if (data.atencaoAbertos > 0 && data.atencaoAbertos <= 5) {
          incidentesCriticosAbertos.style.color = '#FFCA67';
        } else if (data.atencaoAbertos > 5) {
          incidentesCriticosAbertos.style.color = '#FF0267';
        }
        incidentesAtencaoTotais.innerHTML = `${data.atencaoTotais}`;
        incidentesFechados.innerHTML = `${data.fechados}`;
        incidentesRegistrados.innerHTML = `${data.totais}`;
      });
  }

  let jsonDadosComponentes;

  function buscarDadosComponentes() {
    const fetchPromise = fetch("https://sxogicvqs5hrftapsoul2fmegu0sugtj.lambda-url.us-east-1.on.aws/");

    fetchPromise
      .then((response) => response.json())
      .then((data) => {
        jsonDadosComponentes = data;
        console.log(data);
        const tbody = document.getElementById('dataTable');
        for (let i = 0; i < data.length - 1; i++) {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${data[i].nomeComponente}</td><td>${data[i].totais}</td><td>${data[i].criticos}</td><td>${data[i].atencao}</td>`;
          tbody.appendChild(tr);
        }
        componentesComMaisIncidentes.innerHTML = `${data[5].componentesComMaisIncidentes}`;
      });
  }

  let listaJsonsKpisPerformance;

  function buscarKpisPerformance() {
    const fetchPromise = fetch("https://srjhgfjyqkpikdxw6ecdcoiisq0cbzwa.lambda-url.us-east-1.on.aws/");

    fetchPromise
      .then((response) => response.json())
      .then((data) => {
        listaJsonsKpisPerformance = data;
        console.log(data);
        if (data[0].MTBFhoras < 4) {
          divIconeMTBF.style.background = '#FF0267';
          divIconeMTBF.innerHTML = `<img src="../../Images/PopUpsDash/critico.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMTBF()">`;
          conteudoMTBF.innerHTML = `<p class="titulo">Tempo M√©dio Entre Falhas (MTBF)</p>
                    <h2 id="mtbf">${data[0].MTBFhoras}h${data[0].MTBFminutos}min</h2>
                    <p class="descricao"><i>Tempo m√©dio que o sistema opera antes de falhas.</i></p>`
          mtbf.style.color = '#B4044B';
        } else if (4 <= data[0].MTBFhoras && data[0].MTBFhoras <= 24) {
          divIconeMTBF.style.background = '#FFCA67';
          divIconeMTBF.innerHTML = `<img src="../../Images/PopUpsDash/alerta.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMTBF()">`;
          conteudoMTBF.innerHTML = `<p class="titulo">Tempo M√©dio Entre Falhas (MTBF)</p>
                    <h2 id="mtbf">${data[0].MTBFhoras}h${data[0].MTBFminutos}min</h2>
                    <p class="descricao"><i>Tempo m√©dio que o sistema opera antes de falhas.</i></p>`
          mtbf.style.color = '#D2A043';
        } else if (data[0].MTBFhoras > 24) {
          divIconeMTBF.style.background = '#00F2B9';
          divIconeMTBF.innerHTML = `<img src="../../Images/PopUpsDash/ok.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMTBF()">`;
          conteudoMTBF.innerHTML = `<p class="titulo">Tempo M√©dio Entre Falhas (MTBF)</p>
                    <h2 id="mtbf">${data[0].MTBFhoras}h${data[0].MTBFminutos}min</h2>
                    <p class="descricao"><i>Tempo m√©dio que o sistema opera antes de falhas.</i></p>`
          mtbf.style.color = '#219A7E';
        }

        if (data[1].MTTRCriticosHoras > 18) {
          divIconeMTTRCritico.style.background = '#FF0267';
          divIconeMTTRCritico.innerHTML = `<img src="../../Images/PopUpsDash/critico.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMttrCritico()">`;
          conteudoMTTRCritico.innerHTML = `<p class="titulo">Tempo M√©dio de Resolu√ß√£o (MTTR) - Cr√≠ticos</p>
                            <h2 id="mttrCritico">${data[1].MTTRCriticosHoras}h${data[1].MTTRCriticosMinutos}min</h2>
                            <p class="descricao"><i>Tempo m√©dio gasto para resolu√ß√£o de um incidente cr√≠tico.</i></p>`;
          mttrCritico.style.color = '#B4044B';
        } else if (12 <= data[1].MTTRCriticosHoras && data[1].MTTRCriticosHoras <= 18) {
          divIconeMTTRCritico.style.background = '#FFCA67';
          divIconeMTTRCritico.innerHTML = `<img src="../../Images/PopUpsDash/alerta.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMttrCritico()">`;
          conteudoMTTRCritico.innerHTML = `<p class="titulo">Tempo M√©dio de Resolu√ß√£o (MTTR) - Cr√≠ticos</p>
                            <h2 id="mttrCritico">${data[1].MTTRCriticosHoras}h${data[1].MTTRCriticosMinutos}min</h2>
                            <p class="descricao"><i>Tempo m√©dio gasto para resolu√ß√£o de um incidente cr√≠tico.</i></p>`;
          mttrCritico.style.color = '#D2A043';
        } else if (data[1].MTTRCriticosHoras < 12) {
          divIconeMTTRCritico.style.background = '#00F2B9';
          divIconeMTTRCritico.innerHTML = `<img src="../../Images/PopUpsDash/ok.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMttrCritico()">`;
          conteudoMTTRCritico.innerHTML = `<p class="titulo">Tempo M√©dio de Resolu√ß√£o (MTTR) - Cr√≠ticos</p>
                            <h2 id="mttrCritico">${data[1].MTTRCriticosHoras}h${data[1].MTTRCriticosMinutos}min</h2>
                            <p class="descricao"><i>Tempo m√©dio gasto para resolu√ß√£o de um incidente cr√≠tico.</i></p>`;
          mttrCritico.style.color = '#219A7E';
        }

        if (data[1].MTTRAtencaoHoras > 36) {
          divIconeMTTRAtencao.style.background = '#FF0267';
          divIconeMTTRAtencao.innerHTML = `<img src="../../Images/PopUpsDash/critico.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMttrAtencao()">`;
          conteudoMTTRAtencao.innerHTML = `<p class="titulo">Tempo M√©dio de Resolu√ß√£o (MTTR) - Aten√ß√£o</p>
                            <h2 id="mttrAtencao">${data[1].MTTRAtencaoHoras}h${data[1].MTTRAtencaoMinutos}min</h2>
                            <p class="descricao"><i>Tempo m√©dio gasto para resolu√ß√£o de um incidente de aten√ß√£o.</i></p>`;
          mttrAtencao.style.color = '#B4044B';
        } else if (24 <= data[1].MTTRAtencaoHoras && data[1].MTTRAtencaoHoras <= 36) {
          divIconeMTTRAtencao.style.background = '#FFCA67';
          divIconeMTTRAtencao.innerHTML = `<img src="../../Images/PopUpsDash/alerta.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMttrAtencao()">`;
          conteudoMTTRAtencao.innerHTML = `<p class="titulo">Tempo M√©dio de Resolu√ß√£o (MTTR) - Aten√ß√£o</p>
                            <h2 id="mttrAtencao">${data[1].MTTRAtencaoHoras}h${data[1].MTTRAtencaoMinutos}min</h2>
                            <p class="descricao"><i>Tempo m√©dio gasto para resolu√ß√£o de um incidente de aten√ß√£o.</i></p>`;
          mttrAtencao.style.color = '#D2A043';
        } else if (data[1].MTTRAtencaoHoras < 24) {
          divIconeMTTRAtencao.style.background = '#00F2B9';
          divIconeMTTRAtencao.innerHTML = `<img src="../../Images/PopUpsDash/ok.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMttrAtencao()">`;
          conteudoMTTRAtencao.innerHTML = `<p class="titulo">Tempo M√©dio de Resolu√ß√£o (MTTR) - Aten√ß√£o</p>
                            <h2 id="mttrAtencao">${data[1].MTTRAtencaoHoras}h${data[1].MTTRAtencaoMinutos}min</h2>
                            <p class="descricao"><i>Tempo m√©dio gasto para resolu√ß√£o de um incidente de aten√ß√£o.</i></p>`;
          mttrAtencao.style.color = '#219A7E';
        }

        if (data[2].porcentagemSLA < 90) {
          divIconeSLA.style.background = '#FF0267';
          divIconeSLA.innerHTML = `<img src="../../Images/PopUpsDash/critico.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoSLA()">`;
          conteudoSLA.innerHTML = `<p class="titulo">SLA Compliance - Incidentes Resolvidos</p>
                            <h2 id="slaCompliance">${data[2].porcentagemSLA}%</h2>
                            <p class="descricao"><i>Taxa de incidentes resolvidos no prazo definido em SLA.</i></p>`;
          slaCompliance.style.color = '#B4044B';
        } else if (90 <= data[2].porcentagemSLA && data[2].porcentagemSLA <= 94.9) {
          divIconeSLA.style.background = '#FFCA67';
          divIconeSLA.innerHTML = `<img src="../../Images/PopUpsDash/alerta.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoSLA()">`;
          conteudoSLA.innerHTML = `<p class="titulo">SLA Compliance - Incidentes Resolvidos</p>
                            <h2 id="slaCompliance">${data[2].porcentagemSLA}%</h2>
                            <p class="descricao"><i>Taxa de incidentes resolvidos no prazo definido em SLA.</i></p>`;
          slaCompliance.style.color = '#D2A043';
        } else if (data[2].porcentagemSLA >= 95) {
          divIconeSLA.style.background = '#00F2B9';
          divIconeSLA.innerHTML = `<img src="../../Images/PopUpsDash/ok.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoSLA()">`;
          conteudoSLA.innerHTML = `<p class="titulo">SLA Compliance - Incidentes Resolvidos</p>
                            <h2 id="slaCompliance">${data[2].porcentagemSLA}%</h2>
                            <p class="descricao"><i>Taxa de incidentes resolvidos no prazo definido em SLA.</i></p>`;
          slaCompliance.style.color = '#219A7E';
        }
      });
  }

  let displayInfoMtbf = false;
  function verInfoMTBF() {
    if (displayInfoMtbf == false) {
      divIconeMTBF.innerHTML = `<img id="iconeInfo" src="../../Images/voltar.svg" onclick="verInfoMTBF()">`;
      conteudoMTBF.innerHTML = `<p class="explicacao">Indica a estabilidade do sistema. Quanto maior o tempo, maior a confiabilidade da opera√ß√£o.<br><br>
            Par√¢metros de Sa√∫de:<br> üü¢ Ideal: Acima de 24h<br> üü° Aten√ß√£o: Entre 4h e 24h<br> üî¥ Cr√≠tico: Abaixo de 4h</p>`;
      displayInfoMtbf = true;
    } else if (displayInfoMtbf == true) {
      if (listaJsonsKpisPerformance[0].MTBFhoras < 4) {
        divIconeMTBF.style.background = '#FF0267';
        divIconeMTBF.innerHTML = `<img src="../../Images/PopUpsDash/critico.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMTBF()">`;
        conteudoMTBF.innerHTML = `<p class="titulo">Mean Time Between Failures (MTBF)</p>
                <h2 id="mtbf">${listaJsonsKpisPerformance[0].MTBFhoras}h${listaJsonsKpisPerformance[0].MTBFminutos}min</h2>
                <p class="descricao"><i>Tempo m√©dio que o sistema opera antes de falhas.</i></p>`
        mtbf.style.color = '#B4044B';
      } else if (4 <= listaJsonsKpisPerformance[0].MTBFhoras && listaJsonsKpisPerformance[0].MTBFhoras <= 24) {
        divIconeMTBF.style.background = '#FFCA67';
        divIconeMTBF.innerHTML = `<img src="../../Images/PopUpsDash/alerta.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMTBF()">`;
        conteudoMTBF.innerHTML = `<p class="titulo">Mean Time Between Failures (MTBF)</p>
                <h2 id="mtbf">${listaJsonsKpisPerformance[0].MTBFhoras}h${listaJsonsKpisPerformance[0].MTBFminutos}min</h2>
                <p class="descricao"><i>Tempo m√©dio que o sistema opera antes de falhas.</i></p>`
        mtbf.style.color = '#D2A043';
      } else if (listaJsonsKpisPerformance[0].MTBFhoras > 24) {
        divIconeMTBF.style.background = '#00F2B9';
        divIconeMTBF.innerHTML = `<img src="../../Images/PopUpsDash/ok.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMTBF()">`;
        conteudoMTBF.innerHTML = `<p class="titulo">Mean Time Between Failures (MTBF)</p>
                <h2 id="mtbf">${listaJsonsKpisPerformance[0].MTBFhoras}h${listaJsonsKpisPerformance[0].MTBFminutos}min</h2>
                <p class="descricao"><i>Tempo m√©dio que o sistema opera antes de falhas.</i></p>`
        mtbf.style.color = '#219A7E';
      }
      displayInfoMtbf = false;
    }
  }

  let displayInfoMttrCritico = false;
  function verInfoMttrCritico() {
    if (displayInfoMttrCritico == false) {
      divIconeMTTRCritico.innerHTML = `<img id="iconeInfo" src="../../Images/voltar.svg" onclick="verInfoMttrCritico()">`;
      conteudoMTTRCritico.innerHTML = `<p class="explicacao">Mede o tempo m√©dio que a equipe leva para resolver uma falha cr√≠tica. Para incidentes cr√≠ticos, o tempo deve ser o menor poss√≠vel.<br><br>
            Par√¢metros de Sa√∫de:<br> üü¢ Ideal: Abaixo de 12h<br> üü° Aten√ß√£o: Entre 12h e 18h<br> üî¥ Cr√≠tico: Acima de 18h</p>`;
      displayInfoMttrCritico = true;
    } else if (displayInfoMttrCritico == true) {
      if (listaJsonsKpisPerformance[1].MTTRCriticosHoras > 18) {
        divIconeMTTRCritico.style.background = '#FF0267';
        divIconeMTTRCritico.innerHTML = `<img src="../../Images/PopUpsDash/critico.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMttrCritico()">`;
        conteudoMTTRCritico.innerHTML = `<p class="titulo">Mean Time to Resolve (MTTR) - Cr√≠ticos</p>
                            <h2 id="mttrCritico">${listaJsonsKpisPerformance[1].MTTRCriticosHoras}h${listaJsonsKpisPerformance[1].MTTRCriticosMinutos}min</h2>
                            <p class="descricao"><i>Tempo m√©dio gasto para resolu√ß√£o de um incidente cr√≠tico.</i></p>`;
        mttrCritico.style.color = '#B4044B';
      } else if (12 <= listaJsonsKpisPerformance[1].MTTRCriticosHoras && listaJsonsKpisPerformance[1].MTTRCriticosHoras <= 18) {
        divIconeMTTRCritico.style.background = '#FFCA67';
        divIconeMTTRCritico.innerHTML = `<img src="../../Images/PopUpsDash/alerta.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMttrCritico()">`;
        conteudoMTTRCritico.innerHTML = `<p class="titulo">Mean Time to Resolve (MTTR) - Cr√≠ticos</p>
                            <h2 id="mttrCritico">${listaJsonsKpisPerformance[1].MTTRCriticosHoras}h${listaJsonsKpisPerformance[1].MTTRCriticosMinutos}min</h2>
                            <p class="descricao"><i>Tempo m√©dio gasto para resolu√ß√£o de um incidente cr√≠tico.</i></p>`;
        mttrCritico.style.color = '#D2A043';
      } else if (listaJsonsKpisPerformance[1].MTTRCriticosHoras < 12) {
        divIconeMTTRCritico.style.background = '#00F2B9';
        divIconeMTTRCritico.innerHTML = `<img src="../../Images/PopUpsDash/ok.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMttrCritico()">`;
        conteudoMTTRCritico.innerHTML = `<p class="titulo">Mean Time to Resolve (MTTR) - Cr√≠ticos</p>
                            <h2 id="mttrCritico">${listaJsonsKpisPerformance[1].MTTRCriticosHoras}h${listaJsonsKpisPerformance[1].MTTRCriticosMinutos}min</h2>
                            <p class="descricao"><i>Tempo m√©dio gasto para resolu√ß√£o de um incidente cr√≠tico.</i></p>`;
        mttrCritico.style.color = '#219A7E';
      }
      displayInfoMttrCritico = false;
    }
  }

  let displayInfoMttrAtencao = false;
  function verInfoMttrAtencao() {
    if (displayInfoMttrAtencao == false) {
      divIconeMTTRAtencao.innerHTML = `<img id="iconeInfo" src="../../Images/voltar.svg" onclick="verInfoMttrAtencao()">`;
      conteudoMTTRAtencao.innerHTML = `<p class="explicacao">Mede a efici√™ncia na resolu√ß√£o de problemas de menor impacto. O objetivo √© manter o fluxo cont√≠nuo e evitar ac√∫mulo de chamados.<br><br>
            Par√¢metros de Sa√∫de:<br> üü¢ Ideal: Abaixo de 24h<br> üü° Aten√ß√£o: Entre 24h e 36h<br> üî¥ Cr√≠tico: Acima de 36h</p>`;
      displayInfoMttrAtencao = true;
    } else if (displayInfoMttrAtencao == true) {
      if (listaJsonsKpisPerformance[1].MTTRAtencaoHoras > 36) {
        divIconeMTTRAtencao.style.background = '#FF0267';
        divIconeMTTRAtencao.innerHTML = `<img src="../../Images/PopUpsDash/critico.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMttrAtencao()">`;
        conteudoMTTRAtencao.innerHTML = `<p class="titulo">Mean Time to Resolve (MTTR) - Aten√ß√£o</p>
                            <h2 id="mttrAtencao">${listaJsonsKpisPerformance[1].MTTRAtencaoHoras}h${listaJsonsKpisPerformance[1].MTTRAtencaoMinutos}min</h2>
                            <p class="descricao"><i>Tempo m√©dio gasto para resolu√ß√£o de um incidente de aten√ß√£o.</i></p>`;
        mttrAtencao.style.color = '#B4044B';
      } else if (24 <= listaJsonsKpisPerformance[1].MTTRAtencaoHoras && listaJsonsKpisPerformance[1].MTTRAtencaoHoras <= 36) {
        divIconeMTTRAtencao.style.background = '#FFCA67';
        divIconeMTTRAtencao.innerHTML = `<img src="../../Images/PopUpsDash/alerta.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMttrAtencao()">`;
        conteudoMTTRAtencao.innerHTML = `<p class="titulo">Mean Time to Resolve (MTTR) - Aten√ß√£o</p>
                            <h2 id="mttrAtencao">${listaJsonsKpisPerformance[1].MTTRAtencaoHoras}h${listaJsonsKpisPerformance[1].MTTRAtencaoMinutos}min</h2>
                            <p class="descricao"><i>Tempo m√©dio gasto para resolu√ß√£o de um incidente de aten√ß√£o.</i></p>`;
        mttrAtencao.style.color = '#D2A043';
      } else if (listaJsonsKpisPerformance[1].MTTRAtencaoHoras < 24) {
        divIconeMTTRAtencao.style.background = '#00F2B9';
        divIconeMTTRAtencao.innerHTML = `<img src="../../Images/PopUpsDash/ok.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoMttrAtencao()">`;
        conteudoMTTRAtencao.innerHTML = `<p class="titulo">Mean Time to Resolve (MTTR) - Aten√ß√£o</p>
                            <h2 id="mttrAtencao">${listaJsonsKpisPerformance[1].MTTRAtencaoHoras}h${listaJsonsKpisPerformance[1].MTTRAtencaoMinutos}min</h2>
                            <p class="descricao"><i>Tempo m√©dio gasto para resolu√ß√£o de um incidente de aten√ß√£o.</i></p>`;
        mttrAtencao.style.color = '#219A7E';
      }
      displayInfoMttrAtencao = false;
    }
  }

  let displayInfoSLA = false;
  function verInfoSLA() {
    if (displayInfoSLA == false) {
      divIconeSLA.innerHTML = `<img id="iconeInfo" src="../../Images/voltar.svg" onclick="verInfoSLA()">`;
      conteudoSLA.innerHTML = `<p class="explicacao">Representa a porcentagem total de incidentes que foram resolvidos dentro do prazo acordado.<br><br>
            Par√¢metros de Sa√∫de:<br> üü¢ Ideal: Acima de 95%<br> üü° Aten√ß√£o: Entre 90% e 95%<br> üî¥ Cr√≠tico: Abaixo de 90%</p><br>
            SLA:<br>
            Cr√≠ticos - at√© 12h<br>
            Aten√ß√£o - at√© 24h`;
      displayInfoSLA = true;
    } else if (displayInfoSLA == true) {
      if (listaJsonsKpisPerformance[2].porcentagemSLA < 90) {
        divIconeSLA.style.background = '#FF0267';
        divIconeSLA.innerHTML = `<img src="../../Images/PopUpsDash/critico.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoSLA()">`;
        conteudoSLA.innerHTML = `<p class="titulo">SLA Compliance - Incidentes Resolvidos</p>
                            <h2 id="slaCompliance">${listaJsonsKpisPerformance[2].porcentagemSLA}%</h2>
                            <p class="descricao"><i>Taxa de incidentes resolvidos no prazo definido em SLA.</i></p>`;
        slaCompliance.style.color = '#B4044B';
      } else if (90 <= listaJsonsKpisPerformance[2].porcentagemSLA && listaJsonsKpisPerformance[2].porcentagemSLA <= 94.9) {
        divIconeSLA.style.background = '#FFCA67';
        divIconeSLA.innerHTML = `<img src="../../Images/PopUpsDash/alerta.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoSLA()">`;
        conteudoSLA.innerHTML = `<p class="titulo">SLA Compliance - Incidentes Resolvidos</p>
                            <h2 id="slaCompliance">${listaJsonsKpisPerformance[2].porcentagemSLA}%</h2>
                            <p class="descricao"><i>Taxa de incidentes resolvidos no prazo definido em SLA.</i></p>`;
        slaCompliance.style.color = '#D2A043';
      } else if (listaJsonsKpisPerformance[2].porcentagemSLA >= 95) {
        divIconeSLA.style.background = '#00F2B9';
        divIconeSLA.innerHTML = `<img src="../../Images/PopUpsDash/ok.svg"> <img id="iconeInfo" src="../../assets/icons/icone_info_cards.svg" onclick="verInfoSLA()">`;
        conteudoSLA.innerHTML = `<p class="titulo">SLA Compliance - Incidentes Resolvidos</p>
                            <h2 id="slaCompliance">${listaJsonsKpisPerformance[2].porcentagemSLA}%</h2>
                            <p class="descricao"><i>Taxa de incidentes resolvidos no prazo definido em SLA.</i></p>`;
        slaCompliance.style.color = '#219A7E';
      }
      displayInfoSLA = false;
    }
  }

  function pegarDataUltimaAtualizacao() {
    const agora = new Date();

    const dia = String(agora.getDate()).padStart(2, '0');
    const mes = String(agora.getMonth() + 1).padStart(2, '0');
    const ano = agora.getFullYear();

    const horas = String(agora.getHours()).padStart(2, '0');
    const minutos = String(agora.getMinutes()).padStart(2, '0');
    const segundos = String(agora.getSeconds()).padStart(2, '0');

    let dataHora = `${dia}/${mes}/${ano} - ${horas}:${minutos}:${segundos}`;
    dataUltimaAtualizacao.innerHTML = `<p id="dataUltimaAtualizacao">√öltima atualiza√ß√£o: ${dataHora}</p>`;
  }

  let jsonDadosGrafico;
  var chart;

  function carregarGrafico() {
    const fetchPromise = fetch("https://monitora-client.s3.us-east-1.amazonaws.com/dadosGraficoIncidentes/latest.json", {
      //Usando no-store para for√ßar o navegador a n√£o usar cache
      cache: "no-store"
    });

    fetchPromise
      .then((response) => response.json())
      .then((data) => {
        jsonDadosGrafico = data;
        //Invertendo arrays do json para melhor visualiza√ß√£o no gr√°fico
        jsonDadosGrafico.incidentesFechados.reverse()
        jsonDadosGrafico.incidentesAbertos.reverse()
        jsonDadosGrafico.datas.reverse()
        jsonDadosGrafico.incidentesAbertosRAM.reverse()
        jsonDadosGrafico.incidentesAbertosCPU.reverse()
        jsonDadosGrafico.incidentesAbertosDisco.reverse()
        jsonDadosGrafico.incidentesAbertosLatencia.reverse()
        jsonDadosGrafico.incidentesAbertosUsoRede.reverse()
        console.log(data);
        let options = {
          chart: {
            type: 'line'
          },
          series: [{
            name: 'Incidentes Abertos',
            data: data.incidentesAbertos
          },
          {
            name: 'Incidentes Fechados',
            data: data.incidentesFechados
          }],
          xaxis: {
            categories: data.datas
          },
          title: {
            text: 'Incidentes: Abertos VS Fechados',
            align: 'left'
          },
          stroke: {
            curve: 'smooth'
          },
          markers: {
            size: 1,
          }
        }
        chart = new ApexCharts(document.getElementById("grafico"), options);
        chart.render();
      });
  }

  function alterarGrafico(numeroGrafico) {
    if (chart) {
      chart.destroy(); // Remove o gr√°fico antigo da mem√≥ria limpamnete
      chart = null;
      grafico.innerHTML = '';
      let options = null;
    }
    if (numeroGrafico == 1) {
      options = {
        chart: {
          type: 'line'
        },
        series: [{
          name: 'Incidentes Abertos',
          data: jsonDadosGrafico.incidentesAbertos
        },
        {
          name: 'Incidentes Fechados',
          data: jsonDadosGrafico.incidentesFechados
        }],
        xaxis: {
          categories: jsonDadosGrafico.datas
        },
        title: {
          text: 'Incidentes: Abertos VS Fechados',
          align: 'left'
        },
        stroke: {
          curve: 'smooth'
        },
        markers: {
          size: 1,
        }
      }
    } else if (numeroGrafico == 2) {
      options = {
        chart: {
          type: 'line'
        },
        series: [{
          name: 'Incidentes Abertos: Mem√≥ria RAM',
          data: jsonDadosGrafico.incidentesAbertosRAM
        },
        {
          name: 'Incidentes Abertos: CPU',
          data: jsonDadosGrafico.incidentesAbertosCPU
        },
        {
          name: 'Incidentes Abertos: Disco',
          data: jsonDadosGrafico.incidentesAbertosDisco
        },
        {
          name: 'Incidentes Abertos: Lat√™ncia',
          data: jsonDadosGrafico.incidentesAbertosLatencia
        },
        {
          name: 'Incidentes Abertos: Uso de Rede',
          data: jsonDadosGrafico.incidentesAbertosUsoRede
        }],
        xaxis: {
          categories: jsonDadosGrafico.datas
        },
        title: {
          text: 'Incidentes Abertos por Componente',
          align: 'left'
        },
        stroke: {
          curve: 'smooth'
        },
        markers: {
          size: 1,
        }
      }
    }
    setTimeout(() => {
      chart = new ApexCharts(document.getElementById("grafico"), options);
      chart.render();
    }, 50);
  }

  // const data = [
  //     { componente: 'Mem√≥ria RAM', incidentesTotais: 35, incidentesCriticos: 52, incidentesAtencao: 70 },
  //     { componente: 'Disco', incidentesTotais: 42, incidentesCriticos: 55, incidentesAtencao: 71 },
  //     { componente: 'CPU', incidentesTotais: 46, incidentesCriticos: 58, incidentesAtencao: 73 },
  //     { componente: 'Uso de Rede (MB)', incidentesTotais: 50, incidentesCriticos: 61, incidentesAtencao: 76 },
  //     { componente: 'Lat√™ncia', incidentesTotais: 47, incidentesCriticos: 60, incidentesAtencao: 78 }
  // ];

  // const tbody = document.getElementById('dataTable');
  // data.slice().reverse().forEach(d => {
  //     const tr = document.createElement('tr');
  //     tr.innerHTML = `<td>${d.componente}</td><td>${d.incidentesCriticos}</td><td>${d.incidentesAtencao}</td><td>${d.incidentesTotais}</td>`;
  //     tbody.appendChild(tr);
  // });
</script>
</body>

</html>